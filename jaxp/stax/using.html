<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    

<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Using StAX (The Java&trade; Tutorials &gt;        
            Java API for XML Processing (JAXP) &gt; Streaming API for XML)
</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
     <meta name="description" content="This JAXP Java tutorial describes Java API for XML Processing (jaxp), XSLT, SAX, and related XML topics" />
     <meta name="keywords" content="java programming, learn java, java sample code, jaxp, xml, xslt, sax" />
        
<style type="text/css">
    body {
        margin-left:10px;
        margin-right:10px;
        line-height: 1.5;
        FONT-FAMILY: Arial, Helvetica, sans-serif; 
        font-size: 0.8em;
    }
    
    a:link{text-decoration:none; color:#09569d;}
    a:visited{text-decoration:none; color: #3a87cf;}
    a:hover{text-decoration:underline; }
        
    code{
        font-family:Monaco,Courier,"Courier New";
    }
    
    .header-container {
        background-color: #fff;
        border-bottom: 1px solid #C1CFDA;
        -webkit-box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
        box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
    }
    
    .bookwrapper {
        width: auto;
        margin: auto;
    }
    
    .clearfix {
    }
    
    .clearfloat {
        clear: both;
        overflow: auto;
        height: 0px;
        font-size: 1px;
        line-height: 0px;
    }
    
    #brandProdName {
        width: auto;
        height: auto;
    }
    
    #logocover {
        display: block;
        background: transparent url(../../images/oracle-java-logo.png) 0px 0px no-repeat;
        height: 50px;
        width: 229px;
        float: left;
    }
    
    #productName {
        font-size: 16px;
        position: relative;
        top: 19px;
        padding-left: 3px;
        color: #457798;
        white-space: nowrap;
        width: 340px;
    }


    .FigureCaption   { 
        font-family: sans-serif; 
        text-align: center;
    }
    
    #TopBar_bl {        
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        margin-left: -110px;
        margin-right: -100px;       
		align: left;
        height: 60px;
    }
    #TopBar_tr {
        width: 100%;
        height: 60px;
    }
    
    #TopBar {
        min-width:700px;
        padding:25px 100px 10px;
        margin-bottom:25px;
        clear:both;
        
        border-bottom:1px solid #d2dde5;
        border-radius: 3px;
    
        background:#efefef; /* Old browsers */
        /* IE9 SVG, needs conditional override of 'filter' to 'none' */
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlMmVmZjkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top,  #ffffff 0%, #e2eff9 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e2eff9)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* IE10+ */
        background: linear-gradient(to bottom,  #ffffff 0%,#e2eff9 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e2eff9',GradientType=0 ); /* IE6-8 */
        
    }
    
    #TopBar_left {
        line-height: 14px;
        position: absolute;
        padding-top: 30px;
        padding-right: 30px;
        padding-left: 30px;
        text-align: left;
        font: 13px/20px Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 20px;
        color: #333;
    }
    
    #TopBar_right {
        line-height: 12px;
        float: right;
        padding-top: 10px;
        padding-right: 30px;
        text-align: left;
    }
    

    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    
     
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 10px;
        margin: 3px;
        padding: 0;
    }
 
    #BreadCrumbs {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    
    #BreadCrumbs a {
        color:#09569d;
    }
    
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }
    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    
    .LeftBar_shown {
        width: 13em;
        float: left;
    }
    
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    
    .LeftBar_hidden {
        display: none;
    }
    
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;       
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }

    .NavBit  {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    
    @media print {
        .NavBit {
            display: none;
        }
    }
    
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    
    #Contents a, .NavBit a, #TagNotes a {
        color:#09569d;
    }
    
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em;
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #333;
		
		
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
	
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #333;
        
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
		font-size:12px;
		font-family:Monaco,Courier,"Courier New";
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }

</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    </head>
<body onload="load()">
    <noscript>
        A browser with JavaScript enabled is required for this page to operate properly.
    </noscript>
        <!-- header -->
    <div class="header-container">
        <div class="bookwrapper  clearfix">       
            <div id="brandProdName">
                <div id="logocover"></div>
                <div id="productName" >Documentation</div>
            </div> 
            <br class="clearfloat" />
        </div>
    </div>
    
    <div id="TopBar">
        <div id="TopBar_tr">
            <div id="TopBar_tl">
                <div id="TopBar_br"> <div id="TopBar_bl"> 
                    <div id="TopBar_left">The Java&trade; Tutorials</div>
                        <div id="TopBar_right"> 
                            <!--
                            <a href="URL" target="_blank">External Link</a><br/>
                            -->

<script type="text/javascript">function search() { var sform = document.getElementById("searchForm"); var srchelem = document.getElementById("searchField"); var srchelemreal = document.getElementById("keywordreal"); var srchval = srchelem.value; if (srchval.length == 0) { return false; } srchelemreal.value = srchval; sform.action = "http://docs.oracle.com/apps/search/search.jsp"; sform.method = "get"; sform.target = "_blank"; sform.submit(); }</script><form id="searchForm" onsubmit="return search()"><input type="hidden" name="category" value="java"/><input type="hidden" name="product" value="e25407-01"/><input type="hidden" name="q" value="" id="keywordreal"/><label for="searchField"><input type="text" id="searchField" size="30" onclick="this.value='';" /></label><input type="submit" value="Search" /></form>
              
                            <a href="javascript:toggleLeft()" id="ToggleLeft">Hide TOC</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">Streaming API for XML</a></div>
<div class="linkAHEAD"><a href="why.html">Why StAX?</a></div>
<div class="linkAHEAD"><a href="api.html">StAX API</a></div>
<div class="nolinkAHEAD">Using StAX</div>
<div class="linkAHEAD"><a href="parser.html">Oracle's Streaming XML Parser Implementation</a></div>
<div class="linkAHEAD"><a href="example.html">Example Code</a></div>
<div class="linkAHEAD"><a href="info.html">Further Information</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
    <div class="PrintHeaders">
        <b>Trail:</b> Java API for XML Processing (JAXP)
        <br /><b>Lesson:</b> Streaming API for XML
    </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Home Page</a>
                &gt;
                <a href="../index.html" target="_top">Java API for XML Processing (JAXP)</a>
                &gt;
                <a href="index.html" target="_top">Streaming API for XML</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="api.html">&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target="_top" href="../TOC.html">Trail</a>&nbsp;&bull;&nbsp;<a target="_top" href="parser.html">Next&nbsp;&raquo;</a>
            </div>
            <div class="Banner"><p style="background-color: rgb(247, 248, 249); border-width: 1px; padding: 10px; font-style: italic; border-style: solid; border-color: rgb(64, 74, 91);">The Java Tutorials have been written for JDK 8. Examples and practices described in this page don't take advantage of improvements introduced in later releases and might use technology no longer available.<br/>See <a href="https://docs.oracle.com/pls/topic/lookup?ctx=en/java/javase&id=java_language_changes">Java Language Changes</a> for a summary of updated language features in Java SE 9 and subsequent releases.<br/>See <a href="https://www.oracle.com/technetwork/java/javase/jdk-relnotes-index-2162236.html">JDK Release Notes</a> for information about new features, enhancements, and removed or deprecated options for all JDK releases.</p></div>
            <div id="PageTitle"><h1>Using StAX</h1></div>
            <div id="PageContent">

<!-- Using StAX -->
<p><a name="indexterm-22" id="indexterm-22"></a></p>
<p>In general, StAX programmers create XML stream readers, writers, and events by using the <tt>XMLInputFactory</tt>, <tt>XMLOutputFactory</tt>, and <tt>XMLEventFactory</tt> classes. Configuration is done by setting properties on the factories, whereby implementation-specific settings can be passed to the underlying implementation using the <tt>setProperty</tt> method on the factories. Similarly, implementation-specific settings can be queried using the <tt>getProperty</tt> factory method.</p>
<p>The <tt>XMLInputFactory</tt>, <tt>XMLOutputFactory</tt>, and <tt>XMLEventFactory</tt> classes are described below, followed by discussions of resource allocation, namespace and attribute management, error handling, and then finally reading and writing streams using the cursor and iterator APIs.</p>
<p><a name="bnben" id="bnben"></a></p>
<h2>StAX Factory Classes</h2>
<p><a name="indexterm-23" id="indexterm-23"></a><a name="indexterm-24" id="indexterm-24"></a></p>
<p>The StAX factory classes. <tt>XMLInputFactory</tt>, <tt>XMLOutputFactory</tt>, and <tt>XMLEventFactory</tt>, let you define and configure implementation instances of XML stream reader, stream writer, and event classes.</p>
<p><a name="bnbeo" id="bnbeo"></a></p>
<h3>XMLInputFactory</h3>
<p><a name="indexterm-25" id="indexterm-25"></a><a name="indexterm-26" id="indexterm-26"></a></p>
<p>The <tt>XMLInputFactory</tt> class lets you configure implementation instances of XML stream reader processors created by the factory. New instances of the abstract class <tt>XMLInputFactory</tt> are created by calling the <tt>newInstance</tt> method on the class. The static method <tt>XMLInputFactory.newInstance</tt> is then used to create a new factory instance.</p>
<p>Deriving from JAXP, the <tt>XMLInputFactory.newInstance</tt> method determines the specific <tt>XMLInputFactory</tt> implementation class to load by using the following lookup procedure:</p>
<ol>
<li>
<p>Use the <tt>javax.xml.stream.XMLInputFactory</tt> system property.</p>
</li>
<li>
<p>Use the <tt>lib/xml.stream.properties</tt> file in the Java SE platform&#39;s Java Runtime Environment (JRE) directory.</p>
</li>
<li>
<p>Use the Services API, if available, to determine the classname by looking in the <tt>META-INF/services/javax.xml.stream.XMLInputFactory</tt> files in JAR files available to the JRE.</p>
</li>
<li>
<p>Use the platform default <tt>XMLInputFactory</tt> instance.</p>
</li>
</ol>
<p>After getting a reference to an appropriate <tt>XMLInputFactory</tt>, an application can use the factory to configure and create stream instances. The following table lists the properties supported by <tt>XMLInputFactory</tt>. See the StAX specification for a more detailed listing.</p>
<p><a name="bnbep" id="bnbep"></a></p>
<table summary="javax.xml.stream.XMLInputFactory Properties" border="1">
<caption><tt>javax.xml.stream.XMLInputFactory</tt> Properties</caption>
<col width="35%" />
<col width="64%" />
<tr>
<th id="h1" align="left" valign="top">
<p>Property</p>
</th>
<th id="h2" align="left" valign="top">
<p>Description</p>
</th>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>isValidating</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p>Turns on implementation-specific validation.</p>
</td>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>isCoalescing</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p><b>(Required)</b> Requires the processor to coalesce adjacent character data.</p>
</td>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>isNamespaceAware</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p>Turns off namespace support. All implementations must support namespaces. Support for non-namespace-aware documents is optional.</p>
</td>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>isReplacingEntityReferences</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p><b>(Required)</b> Requires the processor to replace internal entity references with their replacement value and report them as characters or the set of events that describe the entity.</p>
</td>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>isSupportingExternalEntities</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p><b>(Required)</b> Requires the processor to resolve external parsed entities.</p>
</td>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>reporter</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p><b>(Required)</b> Sets and gets the implementation of the <tt>XMLReporter</tt> interface.</p>
</td>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>resolver</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p><b>(Required)</b> Sets and gets the implementation of the <tt>XMLResolver</tt> interface.</p>
</td>
</tr>
<tr>
<td headers="h1" align="left" valign="top">
<p><tt>allocator</tt></p>
</td>
<td headers="h2" align="left" valign="top">
<p><b>(Required)</b> Sets and gets the implementation of the <tt>XMLEventAllocator</tt> interface.</p>
</td>
</tr>
</table>
<p><a name="bnbeq" id="bnbeq"></a></p>
<h3>XMLOutputFactory</h3>
<p><a name="indexterm-27" id="indexterm-27"></a><a name="indexterm-28" id="indexterm-28"></a></p>
<p>New instances of the abstract class <tt>XMLOutputFactory</tt> are created by calling the <tt>newInstance</tt> method on the class. The static method <tt>XMLOutputFactory.newInstance</tt> is then used to create a new factory instance. The algorithm used to obtain the instance is the same as for <tt>XMLInputFactory</tt> but references the <tt>javax.xml.stream.XMLOutputFactory</tt> system property.</p>
<p><tt>XMLOutputFactory</tt> supports only one property, <tt>javax.xml.stream.isRepairingNamespaces</tt>. This property is required, and its purpose is to create default prefixes and associate them with Namespace URIs. See the StAX specification for more information.</p>
<p><a name="bnber" id="bnber"></a></p>
<h3>XMLEventFactory</h3>
<p><a name="indexterm-29" id="indexterm-29"></a><a name="indexterm-30" id="indexterm-30"></a></p>
<p>New instances of the abstract class <tt>XMLEventFactory</tt> are created by calling the <tt>newInstance</tt> method on the class. The static method <tt>XMLEventFactory.newInstance</tt> is then used to create a new factory instance. This factory references the <tt>javax.xml.stream.XMLEventFactory</tt> property to instantiate the factory. The algorithm used to obtain the instance is the same as for <tt>XMLInputFactory</tt> and <tt>XMLOutputFactory</tt> but references the <tt>javax.xml.stream.XMLEventFactory</tt> system property.</p>
<p>There are no default properties for <tt>XMLEventFactory</tt>.</p>
<p><a name="bnbes" id="bnbes"></a></p>
<h2>Resources, Namespaces, and Errors</h2>
<p><a name="indexterm-31" id="indexterm-31"></a></p>
<p>The StAX specification handles resource resolution, attributes and namespace, and errors and exceptions as described below.</p>
<p><a name="bnbet" id="bnbet"></a></p>
<h3>Resource Resolution</h3>
<p>The <tt>XMLResolver</tt> interface provides a means to set the method that resolves resources during XML processing. An application sets the interface on <tt>XMLInputFactory</tt>, which then sets the interface on all processors created by that factory instance.</p>
<p><a name="bnbeu" id="bnbeu"></a></p>
<h3>Attributes and Namespaces</h3>
<p>Attributes are reported by a StAX processor using lookup methods and strings in the cursor interface, and <tt>Attribute</tt> and <tt>Namespace</tt> events in the iterator interface. Note here that namespaces are treated as attributes, although namespaces are reported separately from attributes in both the cursor and iterator APIs. Note also that namespace processing is optional for StAX processors. See the StAX specification for complete information about namespace binding and optional namespace processing.</p>
<p><a name="bnbev" id="bnbev"></a></p>
<h3>Error Reporting and Exception Handling</h3>
<p>All fatal errors are reported by way of the <tt>javax.xml.stream.XMLStreamException</tt> interface. All nonfatal errors and warnings are reported using the <tt>javax.xml.stream.XMLReporter</tt> interface.</p>
<p><a name="bnbew" id="bnbew"></a></p>
<h2>Reading XML Streams</h2>
<p><a name="indexterm-32" id="indexterm-32"></a><a name="indexterm-33" id="indexterm-33"></a></p>
<p>As described earlier in this lesson, the way you read XML streams with a StAX processor&mdash;and more importantly, what you get back&mdash;varies significantly depending on whether you are using the StAX cursor API or the event iterator API. The following two sections describe how to read XML streams with each of these APIs.</p>
<p><a name="bnbex" id="bnbex"></a></p>
<h3>Using XMLStreamReader</h3>
<p><a name="indexterm-34" id="indexterm-34"></a><a name="indexterm-35" id="indexterm-35"></a></p>
<p>The <tt>XMLStreamReader</tt> interface in the StAX cursor API lets you read XML streams or documents in a forward direction only, one item in the infoset at a time. The following methods are available for pulling data from the stream or skipping unwanted events:</p>
<ul>
<li>
<p>Get the value of an attribute</p>
</li>
<li>
<p>Read XML content</p>
</li>
<li>
<p>Determine whether an element has content or is empty</p>
</li>
<li>
<p>Get indexed access to a collection of attributes</p>
</li>
<li>
<p>Get indexed access to a collection of namespaces</p>
</li>
<li>
<p>Get the name of the current event (if applicable)</p>
</li>
<li>
<p>Get the content of the current event (if applicable)</p>
</li>
</ul>
<p>Instances of <tt>XMLStreamReader</tt> have at any one time a single current event on which its methods operate. When you create an instance of <tt>XMLStreamReader</tt> on a stream, the initial current event is the <tt>START_DOCUMENT</tt> state. The <tt>XMLStreamReader.next</tt> method can then be used to step to the next event in the stream.</p>
<p><a name="bnbey" id="bnbey"></a></p>
<h3>Reading Properties, Attributes, and Namespaces</h3>
<p>The <tt>XMLStreamReader.next</tt> method loads the properties of the next event in the stream. You can then access those properties by calling the <tt>XMLStreamReader.getLocalName</tt> and <tt>XMLStreamReader.getText</tt> methods.</p>
<p>When the <tt>XMLStreamReader</tt> cursor is over a <tt>StartElement</tt> event, it reads the name and any attributes for the event, including the namespace. All attributes for an event can be accessed using an index value, and can also be looked up by namespace URI and local name. Note, however, that only the namespaces declared on the current <tt>StartEvent</tt> are available; previously declared namespaces are not maintained, and redeclared namespaces are not removed.</p>
<p><a name="bnbez" id="bnbez"></a></p>
<h3>XMLStreamReader Methods</h3>
<p><tt>XMLStreamReader</tt> provides the following methods for retrieving information about namespaces and attributes:</p>
<div class="codeblock"><pre>
int getAttributeCount();
String getAttributeNamespace(int index);
String getAttributeLocalName(int index);
String getAttributePrefix(int index);
String getAttributeType(int index);
String getAttributeValue(int index);
String getAttributeValue(String namespaceUri, String localName);
boolean isAttributeSpecified(int index);
</pre></div>
<p>Namespaces can also be accessed using three additional methods:</p>
<div class="codeblock"><pre>
int getNamespaceCount();
String getNamespacePrefix(int index);
String getNamespaceURI(int index);
</pre></div>
<p><a name="bnbfa" id="bnbfa"></a></p>
<h3>Instantiating an XMLStreamReader</h3>
<p>This example, taken from the StAX specification, shows how to instantiate an input factory, create a reader, and iterate over the elements of an XML stream:</p>
<div class="codeblock"><pre>
XMLInputFactory f = XMLInputFactory.newInstance();
XMLStreamReader r = f.createXMLStreamReader( ... );
while(r.hasNext()) {
    r.next();
}
</pre></div>
<p><a name="bnbfb" id="bnbfb"></a></p>
<h3>Using XMLEventReader</h3>
<p><a name="indexterm-36" id="indexterm-36"></a><a name="indexterm-37" id="indexterm-37"></a></p>
<p>The <tt>XMLEventReader</tt> API in the StAX event iterator API provides the means to map events in an XML stream to allocated event objects that can be freely reused, and the API itself can be extended to handle custom events.</p>
<p><tt>XMLEventReader</tt> provides four methods for iteratively parsing XML streams:</p>
<ul>
<li>
<p><tt>next</tt>: Returns the next event in the stream</p>
</li>
<li>
<p><tt>nextEvent</tt>: Returns the next typed XMLEvent</p>
</li>
<li>
<p><tt>hasNext</tt>: Returns true if there are more events to process in the stream</p>
</li>
<li>
<p><tt>peek</tt>: Returns the event but does not iterate to the next event</p>
</li>
</ul>
<p>For example, the following code snippet illustrates the <tt>XMLEventReader</tt> method declarations:</p>
<div class="codeblock"><pre>
package javax.xml.stream;
import java.util.Iterator;

public interface XMLEventReader extends Iterator {
    public Object next();
    public XMLEvent nextEvent() throws XMLStreamException;
    public boolean hasNext();
    public XMLEvent peek() throws XMLStreamException;
    // ...
}
</pre></div>
<p>To read all events on a stream and then print them, you could use the following:</p>
<div class="codeblock"><pre>
while(stream.hasNext()) {
    XMLEvent event = stream.nextEvent();
    System.out.print(event);
}
</pre></div>
<p><a name="bnbfc" id="bnbfc"></a></p>
<h3>Reading Attributes</h3>
<p>You can access attributes from their associated <tt>javax.xml.stream.StartElement</tt>, as follows:</p>
<div class="codeblock"><pre>
public interface StartElement extends XMLEvent {
    public Attribute getAttributeByName(QName name);
    public Iterator getAttributes();
}
</pre></div>
<p>You can use the <tt>getAttributes</tt> method on the <tt>StartElement</tt> interface to use an <tt>Iterator</tt> over all the attributes declared on that <tt>StartElement</tt>.</p>
<p><a name="bnbfd" id="bnbfd"></a></p>
<h3>Reading Namespaces</h3>
<p>Similar to reading attributes, namespaces are read using an <tt>Iterator</tt> created by calling the <tt>getNamespaces</tt> method on the <tt>StartElement</tt> interface. Only the namespace for the current <tt>StartElement</tt> is returned, and an application can get the current namespace context by using <tt>StartElement.getNamespaceContext</tt>.</p>
<p><a name="bnbfe" id="bnbfe"></a></p>
<h2>Writing XML Streams</h2>
<p><a name="indexterm-38" id="indexterm-38"></a><a name="indexterm-39" id="indexterm-39"></a></p>
<p>StAX is a bidirectional API, and both the cursor and event iterator APIs have their own set of interfaces for writing XML streams. As with the interfaces for reading streams, there are significant differences between the writer APIs for cursor and event iterator. The following sections describe how to write XML streams using each of these APIs.</p>
<p><a name="bnbff" id="bnbff"></a></p>
<h3>Using XMLStreamWriter</h3>
<p><a name="indexterm-40" id="indexterm-40"></a><a name="indexterm-41" id="indexterm-41"></a></p>
<p>The <tt>XMLStreamWriter</tt> interface in the StAX cursor API lets applications write back to an XML stream or create entirely new streams. XMLStreamWriter has methods that let you:</p>
<ul>
<li>
<p>Write well-formed XML</p>
</li>
<li>
<p>Flush or close the output</p>
</li>
<li>
<p>Write qualified names</p>
</li>
</ul>
<p>Note that <tt>XMLStreamWriter</tt> implementations are not required to perform well-formedness or validity checks on input. While some implementations may perform strict error checking, others may not. The rules you implement are applied to properties defined in the <tt>XMLOutputFactory</tt> class.</p>
<p>The <tt>writeCharacters</tt> method is used to escape characters such as <tt>&amp;</tt>, <tt>&lt;</tt>, <tt>&gt;</tt>, and <tt>&quot;</tt>. Binding prefixes can be handled by either passing the actual value for the prefix, by using the <tt>setPrefix</tt> method, or by setting the property for defaulting namespace declarations.</p>
<p>The following example, taken from the StAX specification, shows how to instantiate an output factory, create a writer, and write XML output:</p>
<div class="codeblock"><pre>
XMLOutputFactory output = XMLOutputFactory.newInstance();
XMLStreamWriter writer = output.createXMLStreamWriter( ... );

writer.writeStartDocument();
writer.setPrefix("c","http://c");
writer.setDefaultNamespace("http://c");

writer.writeStartElement("http://c","a");
writer.writeAttribute("b","blah");
writer.writeNamespace("c","http://c");
writer.writeDefaultNamespace("http://c");

writer.setPrefix("d","http://c");
writer.writeEmptyElement("http://c","d");
writer.writeAttribute("http://c", "chris","fry");
writer.writeNamespace("d","http://c");
writer.writeCharacters("Jean Arp");
writer.writeEndElement();

writer.flush();
</pre></div>
<p>This code generates the following XML (new lines are non-normative):</p>
<div class="codeblock"><pre>
&lt;?xml version=&rsquo;1.0&rsquo; encoding=&rsquo;utf-8&rsquo;?>
&lt;a b="blah" xmlns:c="http://c" xmlns="http://c">
&lt;d:d d:chris="fry" xmlns:d="http://c"/>Jean Arp&lt;/a>
</pre></div>
<p><a name="bnbfg" id="bnbfg"></a></p>
<h3>Using XMLEventWriter</h3>
<p><a name="indexterm-42" id="indexterm-42"></a><a name="indexterm-43" id="indexterm-43"></a></p>
<p>The <tt>XMLEventWriter</tt> interface in the StAX event iterator API lets applications write back to an XML stream or create entirely new streams. This API can be extended, but the main API is as follows:</p>
<div class="codeblock"><pre>
public interface XMLEventWriter {
    public void flush() throws XMLStreamException;
    public void close() throws XMLStreamException;
    public void add(XMLEvent e) throws XMLStreamException;
    // ... other methods not shown.
}
</pre></div>
<p>Instances of <tt>XMLEventWriter</tt> are created by an instance of <tt>XMLOutputFactory</tt>. Stream events are added iteratively, and an event cannot be modified after it has been added to an event writer instance.</p>
<p><a name="bnbfh" id="bnbfh"></a></p>
<h3>Attributes, Escaping Characters, Binding Prefixes</h3>
<p>StAX implementations are required to buffer the last <tt>StartElement</tt> until an event other than <tt>Attribute</tt> or <tt>Namespace</tt> is added or encountered in the stream. This means that when you add an <tt>Attribute</tt> or a <tt>Namespace</tt> to a stream, it is appended the current <tt>StartElement</tt> event.</p>
<p>You can use the <tt>Characters</tt> method to escape characters like <tt>&amp;</tt>, <tt>&lt;</tt>, <tt>&gt;</tt>, and <tt>&quot;</tt>.</p>
<p>The <tt>setPrefix(...)</tt> method can be used to explicitly bind a prefix for use during output, and the <tt>getPrefix(...)</tt> method can be used to get the current prefix. Note that by default, <tt>XMLEventWriter</tt> adds namespace bindings to its internal namespace map. Prefixes go out of scope after the corresponding <tt>EndElement</tt> for the event in which they are bound.</p>


        </div>
        <div class="NavBit">
            <a target="_top" href="api.html">&laquo; Previous</a>
            &bull;
            <a target="_top" href="../TOC.html">Trail</a>
            &bull;
            <a target="_top" href="parser.html">Next &raquo;</a>
        </div>
    </div>
    
<hr class="clearfloat"/>

<div id="Footer">

<p class="footertext">
<a href="http://www.oracle.com/corporate/index.html">About Oracle</a> | 
<a href="http://www.oracle.com/us/corporate/contact/index.html">Contact Us</a> |
<a href="http://www.oracle.com/us/legal/index.html">Legal Notices</a> | 
<a href="http://www.oracle.com/us/legal/terms/index.html">Terms of Use</a> |
<a href="http://www.oracle.com/us/legal/privacy/index.html">Your Privacy Rights</a></p>

<p class="footertext"><a href="http://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en-US">
Copyright &copy; 1995, 2020 Oracle and/or its affiliates. All rights reserved.</a></p>
       
</div>    
    <div class="PrintHeaders">
        <b>Previous page:</b> StAX API
        <br /><b>Next page:</b> Oracle's Streaming XML Parser Implementation
    </div>
</body>
</html> 
